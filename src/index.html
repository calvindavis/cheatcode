<!DOCTYPE html>
<html>
	<head>
		<title>Cheatcode demo</title>
	</head>
	<body>
		<h1>Cheatcode</h1>
		<p id="p1" tabindex="0">
			Focus on this paragraph element and type the word "cheatcode".
		</p>
		<p id="p2" tabindex="0" style="position: relative">
			Focus on this paragraph element and type "progress";
			<span
				style="
					position: absolute;
					top: 0;
					left: 0;
					bottom: 0;
					background-color: yellow;
					z-index: -1;
					transition: all 0.3s;
				"
			></span>
		</p>
		<script type="module">
			import cheatcode from "./cheatcode";

			const p1 = document.querySelector("#p1");
			cheatcode(p1, {
				code: "cheatcode",
				once: true,
			});

			p1.addEventListener("cheatcode", function (event) {
				const detail = event.detail;
				console.log(detail);

				if (detail.complete) {
					alert(
						`You did it ${detail.completions} time${
							detail.completions === 1 ? "" : "s"
						}!`
					);
				}
			});

			const p2 = document.querySelector("#p2");
			const p2Div = p2.querySelector("span");

			cheatcode(p2, "progress");

			p2.addEventListener("cheatcode", function (event) {
				if (event.detail.correct) {
					p2Div.style.backgroundColor = event.detail.complete
						? "limegreen"
						: "yellow";
					p2Div.style.width = `${100 * event.detail.progress}%`;
				} else {
					p2Div.style.backgroundColor = "red";
				}
			});
		</script>
	</body>
</html>
